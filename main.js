!function(){"use strict";var e=class{constructor(e,t){this._formElement=t,this._inputSelector=e.inputSelector,this._submitButton=this._formElement.querySelector(e.submitButtonSelector),this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._inputElements=[...this._formElement.querySelectorAll(this._inputSelector)]}_showInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent=""}_checkFormValidity(){return this._inputElements.every((e=>e.validity.valid))}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}toggleButtonState(){this._checkFormValidity()?(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1):(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0)}_setEventListeners(){this._inputElements.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}},t=class{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._popupElementCloseBtn=this._popupElement.querySelector(".modal__close")}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("modal_opened")||e.target.classList.contains("modal__close"))&&this.close()})),this._popupElementCloseBtn.addEventListener("click",(()=>{this.close()}))}},r=class extends t{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._submitButton=this._popupForm.querySelector(".modal__button")}setLoading(e){this._submitButton.textContent=e?"Saving...":"Save"}_getInputValues(){return this._inputList=this._popupElement.querySelectorAll(".modal__input"),this._formValues={},this._inputList.forEach((e=>this._formValues[e.name]=e.value)),this._formValues}setEventListeners(){this._popupElement.addEventListener("submit",(()=>{this._handleFormSubmit(this._getInputValues()),this.close()})),super.setEventListeners()}close(){this._popupForm.reset(),super.close()}};const s=new class{constructor(e){let{baseUrl:t,authToken:r,headers:s}=e;this._baseUrl=t,this._authToken=r,this._headers=s}_processResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:{authorization:this._authToken}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error("Error:",e)}))}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:{authorization:this._authToken}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{throw console.error("Error:",e),e}))}updateProfile(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:{authorization:this._authToken,"Content-Type":"application/json"},body:JSON.stringify({name:e.name,about:e.description})}).then((e=>this._processResponse(e))).catch((e=>{console.error("Error:",e)}))}addCard(e){let{name:t,link:r}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:{authorization:this._authToken,"Content-Type":"application/json"},body:JSON.stringify({name:t,link:r})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error("Error:",e)}))}removeCard(e){return console.log(e),fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:{authorization:this._authToken,"Content-Type":"application/json"}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.log(e)}))}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:{authorization:this._authToken,"Content-Type":"application/json"}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error("Error:",e)}))}unlikeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:{authorization:this._authToken,"Content-Type":"application/json"}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error("Error:",e)}))}updateProfileAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:{authorization:this._authToken,"Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error("Error:",e)}))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",authToken:"5c996316-6337-4579-a87d-d8a06991f1d4"}),o=document.querySelector("#profile-edit-button"),n=document.querySelector("#profile-edit-modal"),i=document.querySelector("#add-card-modal"),a=(document.querySelector("#preview-image-modal"),document.querySelector("#profile-title")),l=document.querySelector("#profile-description"),c=i.querySelector(".modal__form"),d=document.querySelector(".card"),u=(document.querySelectorAll(".modal"),document.querySelector("#profile-close-button")),h=document.querySelector("#card-close-button"),_=document.querySelector(".profile__add-button"),m=document.querySelector("#delete-modal-button"),p=document.querySelector(".profile__avatar-button"),E=document.querySelector("#avatar-close-button"),v=document.querySelector(".profile__image"),k=document.querySelector("#avatar-edit-modal"),S=(document.querySelector("#save-avatar-button"),document.querySelector("#profile-description-input")),y=document.querySelector("#profile-title-input"),L=c.querySelector(".modal__input_type_title"),f=c.querySelector(".modal__input_type_link");function b(e,t){t?s.unlikeCard(e).then((e=>{this._likes=e.isLiked,this._renderLikes()})).catch((e=>{console.error(e)})):s.likeCard(e).then((e=>{this._likes=e.isLiked,this._renderLikes()})).catch((e=>{console.error(e)}))}const C=new r("#avatar-edit-modal",(function(e){C.setLoading(!0),s.updateProfileAvatar(e.link).then((e=>{q.setUserAvatar(e.avatar),C.close()})).catch((e=>{console.error(e)})).finally((()=>{C.setLoading(!1,"Saving")}))}));C.setEventListeners(),p.addEventListener("click",(()=>C.open()));const q=new class{constructor(e,t,r){this.name=e,this.description=t,this._avatarElement=r}getUserInfo(){return{description:this.description.textContent,name:this.name.textContent}}setUserInfo(e){let{name:t,description:r}=e;this.name.textContent=t,this.description.textContent=r}setUserAvatar(e){this._avatarElement.src=e}}(a,l,v);s.getUserInfo().then((e=>{q.setUserInfo({name:e.name,description:e.about})}));const g=new r("#profile-edit-modal",(function(e){g.setLoading(!0),s.updateProfile(e).then((()=>{g.close(),location.reload()})).catch((e=>{console.error(e)})).finally((()=>{g.setLoading(!1)}))}));g.setEventListeners();const I=new r("#add-card-modal",(function(){const{value:e}=L,{value:t}=f,r={name:e,link:t};s.addCard(r).then((e=>{A(e,d),I.close()})).catch((e=>{console.error(e)}))}));I.setEventListeners();const w=new class extends t{constructor(e){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._deleteButton=this._popupElement.querySelector(".modal__delete-button")}setSubmitAction(e){this._handleFormSubmit=e}setLoading(e){this._popupForm.textContent=e?"Loading...":"Yes"}_handleSubmit=e=>{e.preventDefault(),this._handleFormSubmit()};close(){super.close(),this._popupForm.removeEventListener("submit",this._handleSubmit)}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",this._handleSubmit)}}("#card__delete-modal");function T(e){w.setSubmitAction((()=>{w.setLoading(!0),s.removeCard(e).then((()=>{w.close(),location.reload()})).catch((e=>{console.error(e)})).finally((()=>{w.setLoading(!1)}))})),w.open()}w.setEventListeners();const j={inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},B=n.querySelector(".modal__form"),$=i.querySelector(".modal__form"),U=k.querySelector(".modal__form"),P=new e(j,B),x=new e(j,$),V=new e(j,U);let F;P.enableValidation(),x.enableValidation(),V.enableValidation();const A=e=>{const t=new class{constructor(e,t,r,s,o){let{name:n,link:i,isLiked:a,_id:l,ownerId:c,userId:d,myId:u}=e;this._name=n,this._link=i,this._likes=a,this._cardSelector=t,this._handleCardClick=r,this._handleDeleteCardClick=s,this._handleCardLikeClick=o,this._likesNum=0,this._cardId=l,this._userId=d,this._ownerId=c,this._myId=u}getId(){return this._id}_getData(){return{name:this._name,link:this._link}}setLikesStatus(e){this._likes=e,this._renderLikes()}_renderLikes(){const e=this._cardElement.querySelector(".card__like-button");this._likes?e.classList.add("card__like-button_active"):e.classList.remove("card__like-button_active")}_setEventListeners(){this._cardElement.querySelector(".card__like-button").addEventListener("click",(()=>{this._handleCardLikeClick(this._cardId,this._likes)})),this._cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>{this._handleDeleteCardClick(this._cardId)})),this._cardElement.querySelector(".card__image").addEventListener("click",(()=>{this._handleCardClick(this._name,this._link)}))}_handleDeleteCardClick(){this._removeCard()}removeCard(){this._cardElement.remove(),this._cardElement=null}_hideDeleteButton(){this._ownerId!==this._userId&&this._cardElement.querySelector(".card__delete-button")}getView(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card__list").cloneNode(!0),this._cardElement.querySelector(".card__title").innerText=this._name,this._cardElement.querySelector(".card__image").src=this._link,this._cardElement.querySelector(".card__image").alt=this._name,this._setEventListeners(),this._renderLikes(),this._cardElement}}(e,"#card-template",z,T,b);F.addItem(t.getView())};s.getInitialCards().then((e=>{F=new class{constructor(e,t){let{items:r,renderer:s}=e;this._items=r,this._renderer=s,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({items:e.reverse(),renderer:A},".card"),F.renderItems()}));const D=new class extends t{constructor(e){super({popupSelector:e}),this._popupImage=this._popupElement.querySelector(".modal__image"),this._previewText=this._popupElement.querySelector(".modal__preview-title")}open(e,t){this._popupImage.src=t,this._popupImage.alt=e,this._previewText.textContent=e,super.open()}}("#preview-image-modal");function z(e,t){D.open(e,t)}D.setEventListeners(),o.addEventListener("click",(function(){!function(){const e=q.getUserInfo();y.value=e.name,S.value=e.description}(),g.open()})),u.addEventListener("click",(()=>g.close())),_.addEventListener("click",(()=>{x.toggleButtonState(),I.open()})),h.addEventListener("click",(()=>I.close())),m.addEventListener("click",(()=>{w.close()})),E.addEventListener("click",(()=>{C.close()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LE1BQU1WLE1BQ1IsR0x5UDJDLHdCQUc3QyxTQUFTc0gsRUFBZ0JwRyxFQUFNb0MsR0FDN0J3RyxFQUFrQjlKLEtBQUtrQixFQUFNb0MsRUFDL0IsQ0FKQXdHLEVBQWtCekosb0JBUWxCeUQsRUFBa0J2RSxpQkFBaUIsU0FsR25DLFlBN0RBLFdBQ0UsTUFBTTBLLEVBQWV2RSxFQUFTdkQsY0FDOUIyQyxFQUFrQjNELE1BQVE4SSxFQUFhL0ksS0FDdkMyRCxFQUF3QjFELE1BQVE4SSxFQUFhOUcsV0FDL0MsQ0EwREUrRyxHQUVBbEUsRUFBaUJoRyxNQUNuQixJQStGQXFFLEVBQW1COUUsaUJBQWlCLFNBQVMsSUFBTXlHLEVBQWlCOUYsVUFDcEVxRSxFQUFpQmhGLGlCQUFpQixTQUFTLEtBQ3pDMEgsRUFBaUI5SCxvQkFDakJnSCxFQUFhbkcsTUFBTSxJQUVyQnNFLEVBQWdCL0UsaUJBQWlCLFNBQVMsSUFBTTRHLEVBQWFqRyxVQUM3RHNFLEVBQXVCakYsaUJBQWlCLFNBQVMsS0FDL0M4RyxFQUFnQm5HLE9BQU8sSUFFekJ3RSxFQUF1Qm5GLGlCQUFpQixTQUFTLEtBQy9DK0YsRUFBZ0JwRixPQUFPLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgfVxuICByZW5kZXJJdGVtcygpIHtcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcbiAgICB9KTtcbiAgfVxuXG4gIGFkZEl0ZW0oZWxlbWVudCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFNlY3Rpb247XG4iLCJjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcblxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBzZXR0aW5ncy5pbnB1dFNlbGVjdG9yO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvclxuICAgICk7XG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3M7XG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzO1xuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5ncy5lcnJvckNsYXNzO1xuXG4gICAgdGhpcy5faW5wdXRFbGVtZW50cyA9IFtcbiAgICAgIC4uLnRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvciksXG4gICAgXTtcbiAgfVxuXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcbiAgICApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XG4gIH1cblxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXG4gICAgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gXCJcIjtcbiAgfVxuXG4gIF9jaGVja0Zvcm1WYWxpZGl0eSgpIHtcbiAgICByZXR1cm4gdGhpcy5faW5wdXRFbGVtZW50cy5ldmVyeSgoaW5wdXQpID0+IGlucHV0LnZhbGlkaXR5LnZhbGlkKTtcbiAgfVxuXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgfVxuICB9XG5cbiAgdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgY29uc3QgaGFzSW52YWxpZElucHV0ID0gdGhpcy5fY2hlY2tGb3JtVmFsaWRpdHkoKTtcbiAgICBpZiAoaGFzSW52YWxpZElucHV0KSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjtcbiIsImNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudENsb3NlQnRuID1cbiAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcbiAgfVxuXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlID0gKGV2dCkgPT4ge1xuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9O1xuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldnQpID0+IHtcbiAgICAgIGlmIChcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9vcGVuZWRcIikgfHxcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9fY2xvc2VcIilcbiAgICAgICkge1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICB0aGlzLl9wb3B1cEVsZW1lbnRDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFBvcHVwO1xuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcbiAgfVxuXG4gIHNldExvYWRpbmcoaXNMb2FkaW5nKSB7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gaXNMb2FkaW5nID8gXCJTYXZpbmcuLi5cIiA6IFwiU2F2ZVwiO1xuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19pbnB1dFwiKTtcblxuICAgIHRoaXMuX2Zvcm1WYWx1ZXMgPSB7fTtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaChcbiAgICAgIChpbnB1dCkgPT4gKHRoaXMuX2Zvcm1WYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZSlcbiAgICApO1xuXG4gICAgcmV0dXJuIHRoaXMuX2Zvcm1WYWx1ZXM7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuXG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfSk7XG5cbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhGb3JtO1xuIiwiLy8gQWxsIGltcG9ydHNcbmltcG9ydCBcIi4uL3BhZ2VzL2luZGV4LmNzc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQgeyBoYW5kbGVDbG9zZVBvcHVwV2l0aE91dHNpZGVDbGljayB9IGZyb20gXCIuLi91dGlscy91dGlscy5qc1wiO1xuXG5pbXBvcnQgUG9wdXAgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXAuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtYXRpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uXCI7XG5cbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXG4gIGF1dGhUb2tlbjogXCI1Yzk5NjMxNi02MzM3LTQ1NzktYTg3ZC1kOGEwNjk5MWYxZDRcIixcbn0pO1xuXG5leHBvcnQgY29uc3QgY2FyZERhdGEgPSB7XG4gIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXG4gIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC95b3NlbWl0ZS5qcGdcIixcbn07XG5cbmV4cG9ydCBjb25zdCBjYXJkTGlzdFNlbGVjdG9yID0gXCIuY2FyZFwiO1xuXG5jb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LWJ1dHRvblwiKTtcbmNvbnN0IHByb2ZpbGVFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiKTtcbmNvbnN0IGFkZENhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbW9kYWxcIik7XG5jb25zdCBwcmV2aWV3SW1hZ2VNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJldmlldy1pbWFnZS1tb2RhbFwiKTtcbmNvbnN0IHByb2ZpbGVUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS10aXRsZVwiKTtcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1kZXNjcmlwdGlvblwiKTtcbmNvbnN0IGFkZENhcmRGb3JtRWxlbWVudCA9IGFkZENhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuY29uc3QgY2FyZExpc3RFTCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKTtcbmNvbnN0IHBvcHVwcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxcIik7XG5cbi8qIEJ1dHRvbnMgRWxlbWVudHMgKi9cbmNvbnN0IHByb2ZpbGVDbG9zZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1jbG9zZS1idXR0b25cIik7XG5jb25zdCBjYXJkQ2xvc2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtY2xvc2UtYnV0dG9uXCIpO1xuY29uc3QgYWRkTmV3Q2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcbmNvbnN0IGRlbGV0ZVBvcHVwQ2xvc2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2RlbGV0ZS1tb2RhbC1idXR0b25cIik7XG5jb25zdCBwcm9maWxlQXZhdGFyQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXItYnV0dG9uXCIpO1xuY29uc3QgYXZhdGFyUG9wdXBDbG9zZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLWNsb3NlLWJ1dHRvblwiKTtcbmNvbnN0IGF2YXRhckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2ltYWdlXCIpO1xuY29uc3QgZWRpdEF2YXRhck1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItZWRpdC1tb2RhbFwiKTtcbmNvbnN0IHNhdmVBdmF0YXJCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3NhdmUtYXZhdGFyLWJ1dHRvblwiKTtcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiXG4pO1xuY29uc3QgcHJvZmlsZVRpdGxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtdGl0bGUtaW5wdXRcIik7XG5jb25zdCBjYXJkVGl0bGVJbnB1dCA9IGFkZENhcmRGb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIi5tb2RhbF9faW5wdXRfdHlwZV90aXRsZVwiXG4pO1xuY29uc3QgY2FyZExpbmtJbnB1dCA9IGFkZENhcmRGb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIi5tb2RhbF9faW5wdXRfdHlwZV9saW5rXCJcbik7XG5jb25zdCBjYXJkU2VsZWN0b3IgPSBcIiNjYXJkLXRlbXBsYXRlXCI7XG5cbi8vIExpa2VzIEFwaVxuXG5mdW5jdGlvbiBoYW5kbGVDYXJkTGlrZUNsaWNrKGNhcmRJZCwgaXNMaWtlZCkge1xuICBpZiAoaXNMaWtlZCkge1xuICAgIGFwaVxuICAgICAgLnVubGlrZUNhcmQoY2FyZElkKVxuICAgICAgLnRoZW4oKGNhcmREYXRhKSA9PiB7XG4gICAgICAgIHRoaXMuX2xpa2VzID0gY2FyZERhdGEuaXNMaWtlZDtcbiAgICAgICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBhcGlcbiAgICAgIC5saWtlQ2FyZChjYXJkSWQpXG4gICAgICAudGhlbigoY2FyZERhdGEpID0+IHtcbiAgICAgICAgdGhpcy5fbGlrZXMgPSBjYXJkRGF0YS5pc0xpa2VkO1xuICAgICAgICB0aGlzLl9yZW5kZXJMaWtlcygpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgIH0pO1xuICB9XG59XG5cbi8vIEVkaXQgQXZhdGFyXG5cbmNvbnN0IGVkaXRBdmF0YXJQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIiNhdmF0YXItZWRpdC1tb2RhbFwiLFxuICBoYW5kbGVFZGl0QXZhdGFyXG4pO1xuXG5mdW5jdGlvbiBoYW5kbGVFZGl0QXZhdGFyKGRhdGEpIHtcbiAgZWRpdEF2YXRhclBvcHVwLnNldExvYWRpbmcodHJ1ZSk7XG4gIGFwaVxuICAgIC51cGRhdGVQcm9maWxlQXZhdGFyKGRhdGEubGluaylcbiAgICAudGhlbigodXNlckRhdGEpID0+IHtcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJBdmF0YXIodXNlckRhdGEuYXZhdGFyKTtcbiAgICAgIGVkaXRBdmF0YXJQb3B1cC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGVkaXRBdmF0YXJQb3B1cC5zZXRMb2FkaW5nKGZhbHNlLCBcIlNhdmluZ1wiKTtcbiAgICB9KTtcbn1cblxuZWRpdEF2YXRhclBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbnByb2ZpbGVBdmF0YXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGVkaXRBdmF0YXJQb3B1cC5vcGVuKCkpO1xuXG4vLyBVc2VyIEluZm8gKyBVcGRhdGUgUHJvZmlsZVxuXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyhwcm9maWxlVGl0bGUsIHByb2ZpbGVEZXNjcmlwdGlvbiwgYXZhdGFyRWxlbWVudCk7XG5cbmZ1bmN0aW9uIGZpbGxQcm9maWxlRm9ybSgpIHtcbiAgY29uc3QgdXNlckluZm9EYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgcHJvZmlsZVRpdGxlSW5wdXQudmFsdWUgPSB1c2VySW5mb0RhdGEubmFtZTtcbiAgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSB1c2VySW5mb0RhdGEuZGVzY3JpcHRpb247XG59XG5cbmFwaS5nZXRVc2VySW5mbygpLnRoZW4oKHVzZXJEYXRhKSA9PiB7XG4gIHVzZXJJbmZvLnNldFVzZXJJbmZvKHtcbiAgICBuYW1lOiB1c2VyRGF0YS5uYW1lLFxuICAgIGRlc2NyaXB0aW9uOiB1c2VyRGF0YS5hYm91dCxcbiAgfSk7XG59KTtcblxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUVkaXRTdWJtaXQoZGF0YSkge1xuICBlZGl0UHJvZmlsZVBvcHVwLnNldExvYWRpbmcodHJ1ZSk7XG4gIGFwaVxuICAgIC51cGRhdGVQcm9maWxlKGRhdGEpXG4gICAgLnRoZW4oKCkgPT4ge1xuICAgICAgZWRpdFByb2ZpbGVQb3B1cC5jbG9zZSgpO1xuICAgICAgbG9jYXRpb24ucmVsb2FkKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGVkaXRQcm9maWxlUG9wdXAuc2V0TG9hZGluZyhmYWxzZSk7XG4gICAgfSk7XG59XG5cbmNvbnN0IGVkaXRQcm9maWxlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIsXG4gIGhhbmRsZVByb2ZpbGVFZGl0U3VibWl0XG4pO1xuZWRpdFByb2ZpbGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyBBZGQgQ2FyZCBBUGlcblxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZEZvcm1TdWJtaXQoKSB7XG4gIGNvbnN0IHsgdmFsdWU6IG5hbWUgfSA9IGNhcmRUaXRsZUlucHV0O1xuICBjb25zdCB7IHZhbHVlOiBsaW5rIH0gPSBjYXJkTGlua0lucHV0O1xuICBjb25zdCBjYXJkRGF0YSA9IHsgbmFtZSwgbGluayB9O1xuXG4gIGFwaVxuICAgIC5hZGRDYXJkKGNhcmREYXRhKVxuICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgIHJlbmRlckNhcmQocmVzLCBjYXJkTGlzdEVMKTtcblxuICAgICAgYWRkQ2FyZFBvcHVwLmNsb3NlKCk7XG4gICAgfSlcblxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgfSk7XG59XG5cbmNvbnN0IGFkZENhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIiNhZGQtY2FyZC1tb2RhbFwiLFxuICBoYW5kbGVBZGRDYXJkRm9ybVN1Ym1pdFxuKTtcbmFkZENhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5mdW5jdGlvbiBvcGVuUHJvZmlsZUZvcm0oKSB7XG4gIGZpbGxQcm9maWxlRm9ybSgpO1xuICBjYXJkTGlzdEVMO1xuICBlZGl0UHJvZmlsZVBvcHVwLm9wZW4oKTtcbn1cblxuLy9EZWxldGUgQ2FyZCBjb25zdFxuXG5jb25zdCBkZWxldGVDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoQ29uZmlybWF0aW9uKFwiI2NhcmRfX2RlbGV0ZS1tb2RhbFwiKTtcblxuZGVsZXRlQ2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmxldCBuZXdDYXJkO1xuXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDYXJkQ2xpY2soY2FyZElkKSB7XG4gIGRlbGV0ZUNhcmRQb3B1cC5zZXRTdWJtaXRBY3Rpb24oKCkgPT4ge1xuICAgIGRlbGV0ZUNhcmRQb3B1cC5zZXRMb2FkaW5nKHRydWUpO1xuICAgIGFwaVxuICAgICAgLnJlbW92ZUNhcmQoY2FyZElkKVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICBpZiAobmV3Q2FyZCkge1xuICAgICAgICAgIG5ld0NhcmQucmVtb3ZlQ2FyZCgpO1xuICAgICAgICB9XG4gICAgICAgIGRlbGV0ZUNhcmRQb3B1cC5jbG9zZSgpO1xuICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB9KVxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICBkZWxldGVDYXJkUG9wdXAuc2V0TG9hZGluZyhmYWxzZSk7XG4gICAgICB9KTtcbiAgfSk7XG4gIGRlbGV0ZUNhcmRQb3B1cC5vcGVuKCk7XG59XG5cbi8qRm9ybSBWYWxpZGF0aW9uKi9cblxuY29uc3Qgc2V0dGluZ3MgPSB7XG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcbn07XG5cbmNvbnN0IGVkaXRGb3JtRWxlbWVudCA9IHByb2ZpbGVFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbmNvbnN0IGFkZEZvcm1FbGVtZW50ID0gYWRkQ2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5jb25zdCBhdmF0YXJFZGl0Rm9ybUVsZW1lbnQgPSBlZGl0QXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcblxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihzZXR0aW5ncywgZWRpdEZvcm1FbGVtZW50KTtcbmNvbnN0IGFkZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihzZXR0aW5ncywgYWRkRm9ybUVsZW1lbnQpO1xuY29uc3QgYXZhdGFyRWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcbiAgc2V0dGluZ3MsXG4gIGF2YXRhckVkaXRGb3JtRWxlbWVudFxuKTtcblxuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuYWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5hdmF0YXJFZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbi8vIENyZWF0ZSBhbmQgcmVuZGVyIGNhcmRcblxubGV0IGNhcmRTZWN0aW9uO1xuXG5jb25zdCByZW5kZXJDYXJkID0gKGNhcmREYXRhKSA9PiB7XG4gIGNvbnN0IG5ld0NhcmQgPSBuZXcgQ2FyZChcbiAgICBjYXJkRGF0YSxcbiAgICBcIiNjYXJkLXRlbXBsYXRlXCIsXG4gICAgaGFuZGxlQ2FyZENsaWNrLFxuICAgIGhhbmRsZURlbGV0ZUNhcmRDbGljayxcbiAgICBoYW5kbGVDYXJkTGlrZUNsaWNrXG4gICk7XG4gIGNhcmRTZWN0aW9uLmFkZEl0ZW0obmV3Q2FyZC5nZXRWaWV3KCkpO1xufTtcblxuYXBpLmdldEluaXRpYWxDYXJkcygpLnRoZW4oKGNhcmREYXRhKSA9PiB7XG4gIGNhcmRTZWN0aW9uID0gbmV3IFNlY3Rpb24oXG4gICAge1xuICAgICAgaXRlbXM6IGNhcmREYXRhLnJldmVyc2UoKSxcbiAgICAgIHJlbmRlcmVyOiByZW5kZXJDYXJkLFxuICAgIH0sXG4gICAgY2FyZExpc3RTZWxlY3RvclxuICApO1xuICBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcygpO1xufSk7XG5cbi8vUHJldmlldyBQb3B1cCBDb25zdFxuXG5jb25zdCBpbWFnZVByZXZpZXdQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIiNwcmV2aWV3LWltYWdlLW1vZGFsXCIpO1xuaW1hZ2VQcmV2aWV3UG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuZnVuY3Rpb24gaGFuZGxlQ2FyZENsaWNrKG5hbWUsIGxpbmspIHtcbiAgaW1hZ2VQcmV2aWV3UG9wdXAub3BlbihuYW1lLCBsaW5rKTtcbn1cblxuLypFdmVudCBMaXN0ZW5lcnMqL1xuXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgb3BlblByb2ZpbGVGb3JtKTtcbnByb2ZpbGVDbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gZWRpdFByb2ZpbGVQb3B1cC5jbG9zZSgpKTtcbmFkZE5ld0NhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgYWRkRm9ybVZhbGlkYXRvci50b2dnbGVCdXR0b25TdGF0ZSgpO1xuICBhZGRDYXJkUG9wdXAub3BlbigpO1xufSk7XG5jYXJkQ2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGFkZENhcmRQb3B1cC5jbG9zZSgpKTtcbmRlbGV0ZVBvcHVwQ2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgZGVsZXRlQ2FyZFBvcHVwLmNsb3NlKCk7XG59KTtcbmF2YXRhclBvcHVwQ2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgZWRpdEF2YXRhclBvcHVwLmNsb3NlKCk7XG59KTtcbi8vIHNhdmVBdmF0YXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbi8vICAgY29uc3QgYXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LWF2YXRhci1pbnB1dFwiKS52YWx1ZTtcbi8vICAgaGFuZGxlRWRpdEF2YXRhcihhdmF0YXIpO1xuLy8gfSk7XG4iLCJjbGFzcyBBcGkge1xuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGF1dGhUb2tlbiwgaGVhZGVycyB9KSB7XG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XG4gICAgdGhpcy5fYXV0aFRva2VuID0gYXV0aFRva2VuO1xuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xuICB9XG5cbiAgX3Byb2Nlc3NSZXNwb25zZShyZXMpIHtcbiAgICByZXR1cm4gcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgaGVhZGVyczoge1xuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl9hdXRoVG9rZW4sXG4gICAgICB9LFxuICAgIH0pXG4gICAgICAudGhlbigocmVzKSA9PlxuICAgICAgICByZXMub2sgPyByZXMuanNvbigpIDogUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YClcbiAgICAgIClcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvcjpcIiwgZXJyKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fYXV0aFRva2VuLFxuICAgICAgfSxcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT5cbiAgICAgICAgcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApXG4gICAgICApXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3I6XCIsIGVycik7XG4gICAgICAgIHRocm93IGVycjtcbiAgICAgIH0pO1xuICB9XG5cbiAgdXBkYXRlUHJvZmlsZShpbnB1dFZhbHVlcykge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl9hdXRoVG9rZW4sXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgfSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogaW5wdXRWYWx1ZXMubmFtZSxcbiAgICAgICAgYWJvdXQ6IGlucHV0VmFsdWVzLmRlc2NyaXB0aW9uLFxuICAgICAgfSksXG4gICAgfSlcbiAgICAgIC50aGVuKChyZXMpID0+IHRoaXMuX3Byb2Nlc3NSZXNwb25zZShyZXMpKVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yOlwiLCBlcnIpO1xuICAgICAgfSk7XG4gIH1cblxuICBhZGRDYXJkKHsgbmFtZSwgbGluayB9KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fYXV0aFRva2VuLFxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgIH0sXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWUsXG4gICAgICAgIGxpbmssXG4gICAgICB9KSxcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT5cbiAgICAgICAgcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApXG4gICAgICApXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3I6XCIsIGVycik7XG4gICAgICB9KTtcbiAgfVxuXG4gIHJlbW92ZUNhcmQoY2FyZElkKSB7XG4gICAgY29uc29sZS5sb2coY2FyZElkKTtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl9hdXRoVG9rZW4sXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgfSxcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT5cbiAgICAgICAgcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApXG4gICAgICApXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgfSk7XG4gIH1cblxuICBsaWtlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl9hdXRoVG9rZW4sXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgfSxcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT5cbiAgICAgICAgcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApXG4gICAgICApXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3I6XCIsIGVycik7XG4gICAgICB9KTtcbiAgfVxuXG4gIHVubGlrZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fYXV0aFRva2VuLFxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgIH0sXG4gICAgfSlcbiAgICAgIC50aGVuKChyZXMpID0+XG4gICAgICAgIHJlcy5vayA/IHJlcy5qc29uKCkgOiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKVxuICAgICAgKVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yOlwiLCBlcnIpO1xuICAgICAgfSk7XG4gIH1cblxuICB1cGRhdGVQcm9maWxlQXZhdGFyKGF2YXRhcikge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fYXV0aFRva2VuLFxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIiwgLy8gSW5jbHVkZSB0aGUgQ29udGVudC1UeXBlIGhlYWRlclxuICAgICAgfSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgYXZhdGFyIH0pLFxuICAgIH0pXG4gICAgICAudGhlbigocmVzKSA9PlxuICAgICAgICByZXMub2sgPyByZXMuanNvbigpIDogUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YClcbiAgICAgIClcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvcjpcIiwgZXJyKTtcbiAgICAgIH0pO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEFwaTtcbiIsImNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IobmFtZSwgZGVzY3JpcHRpb24sIGF2YXRhckVsZW1lbnQpIHtcbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgIHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgICB0aGlzLl9hdmF0YXJFbGVtZW50ID0gYXZhdGFyRWxlbWVudDtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB7XG4gICAgICBkZXNjcmlwdGlvbjogdGhpcy5kZXNjcmlwdGlvbi50ZXh0Q29udGVudCxcbiAgICAgIG5hbWU6IHRoaXMubmFtZS50ZXh0Q29udGVudCxcbiAgICB9O1xuICB9XG5cbiAgc2V0VXNlckluZm8oeyBuYW1lLCBkZXNjcmlwdGlvbiB9KSB7XG4gICAgdGhpcy5uYW1lLnRleHRDb250ZW50ID0gbmFtZTtcbiAgICB0aGlzLmRlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gZGVzY3JpcHRpb247XG4gIH1cblxuICBzZXRVc2VyQXZhdGFyKGF2YXRhcikge1xuICAgIHRoaXMuX2F2YXRhckVsZW1lbnQuc3JjID0gYXZhdGFyO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFVzZXJJbmZvO1xuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwXCI7XG5cbmNsYXNzIFBvcHVwV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgICB0aGlzLl9kZWxldGVCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLm1vZGFsX19kZWxldGUtYnV0dG9uXCJcbiAgICApO1xuICB9XG5cbiAgc2V0U3VibWl0QWN0aW9uKGFjdGlvbikge1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBhY3Rpb247XG4gIH1cblxuICBzZXRMb2FkaW5nKGlzTG9hZGluZykge1xuICAgIHRoaXMuX3BvcHVwRm9ybS50ZXh0Q29udGVudCA9IGlzTG9hZGluZyA/IFwiTG9hZGluZy4uLlwiIDogXCJZZXNcIjtcbiAgfVxuXG4gIF9oYW5kbGVTdWJtaXQgPSAoZXZlbnQpID0+IHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQoKTtcbiAgfTtcblxuICBjbG9zZSgpIHtcbiAgICBzdXBlci5jbG9zZSgpO1xuICAgIHRoaXMuX3BvcHVwRm9ybS5yZW1vdmVFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX2hhbmRsZVN1Ym1pdCk7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX2hhbmRsZVN1Ym1pdCk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgUG9wdXBXaXRoQ29uZmlybWF0aW9uO1xuIiwiY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIHsgbmFtZSwgbGluaywgaXNMaWtlZCwgX2lkLCBvd25lcklkLCB1c2VySWQsIG15SWQgfSxcbiAgICBjYXJkU2VsZWN0b3IsXG4gICAgaGFuZGxlQ2FyZENsaWNrLFxuICAgIGhhbmRsZURlbGV0ZUNhcmRDbGljayxcbiAgICBoYW5kbGVDYXJkTGlrZUNsaWNrXG4gICkge1xuICAgIHRoaXMuX25hbWUgPSBuYW1lO1xuICAgIHRoaXMuX2xpbmsgPSBsaW5rO1xuICAgIHRoaXMuX2xpa2VzID0gaXNMaWtlZDtcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmRDbGljayA9IGhhbmRsZURlbGV0ZUNhcmRDbGljaztcbiAgICB0aGlzLl9oYW5kbGVDYXJkTGlrZUNsaWNrID0gaGFuZGxlQ2FyZExpa2VDbGljaztcbiAgICB0aGlzLl9saWtlc051bSA9IDA7XG4gICAgdGhpcy5fY2FyZElkID0gX2lkO1xuICAgIHRoaXMuX3VzZXJJZCA9IHVzZXJJZDtcbiAgICB0aGlzLl9vd25lcklkID0gb3duZXJJZDtcbiAgICB0aGlzLl9teUlkID0gbXlJZDtcbiAgfVxuXG4gIGdldElkKCkge1xuICAgIHJldHVybiB0aGlzLl9pZDtcbiAgfVxuXG4gIF9nZXREYXRhKCkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiB0aGlzLl9uYW1lLFxuICAgICAgbGluazogdGhpcy5fbGluayxcbiAgICB9O1xuICB9XG5cbiAgc2V0TGlrZXNTdGF0dXMoaXNMaWtlZCkge1xuICAgIHRoaXMuX2xpa2VzID0gaXNMaWtlZDtcbiAgICB0aGlzLl9yZW5kZXJMaWtlcygpO1xuICB9XG5cbiAgX3JlbmRlckxpa2VzKCkge1xuICAgIGNvbnN0IGxpa2VCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xuICAgIGlmICh0aGlzLl9saWtlcykge1xuICAgICAgbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICBsaWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gICAgfVxuICB9XG5cbiAgLy8gX2Rpc3BsYXlMaWtlQ291bnQoKSB7XG4gIC8vICAgZGVidWdnZXI7XG4gIC8vICAgdGhpcy5fbGlrZXNOdW0gPSB0aGlzLl9saWtlcztcbiAgLy8gICB0aGlzLl9saWtlQ291bnRlci50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzTnVtLnRvU3RyaW5nKCk7XG4gIC8vIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5faGFuZGxlQ2FyZExpa2VDbGljayh0aGlzLl9jYXJkSWQsIHRoaXMuX2xpa2VzKTtcbiAgICAgIH0pO1xuXG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9oYW5kbGVEZWxldGVDYXJkQ2xpY2sodGhpcy5fY2FyZElkKTtcbiAgICAgIH0pO1xuXG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKHRoaXMuX25hbWUsIHRoaXMuX2xpbmspO1xuICAgICAgfSk7XG4gIH1cblxuICAvLyBfaGFuZGxlQ2FyZExpa2VDbGljaygpIHtcbiAgLy8gICB0aGlzLl9jYXJkRWxlbWVudFxuICAvLyAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIilcbiAgLy8gICAgIC5jbGFzc0xpc3QudG9nZ2xlKFwiLmNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgLy8gfVxuXG4gIF9oYW5kbGVEZWxldGVDYXJkQ2xpY2soKSB7XG4gICAgdGhpcy5fcmVtb3ZlQ2FyZCgpO1xuICB9XG5cbiAgcmVtb3ZlQ2FyZCgpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XG4gIH1cblxuICAvLyBfaGFuZGxlRGVsZXRlQ2FyZChjYXJkSWQpIHtcbiAgLy8gICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcbiAgLy8gICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XG4gIC8vIH1cblxuICBfaGlkZURlbGV0ZUJ1dHRvbigpIHtcbiAgICBpZiAodGhpcy5fb3duZXJJZCAhPT0gdGhpcy5fdXNlcklkKSB7XG4gICAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIik7XG4gICAgfVxuICB9XG5cbiAgZ2V0VmlldygpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpc3RcIilcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpLmlubmVyVGV4dCA9IHRoaXMuX25hbWU7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKS5zcmMgPSB0aGlzLl9saW5rO1xuICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIikuYWx0ID0gdGhpcy5fbmFtZTtcblxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcblxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBDYXJkO1xuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xuICAgIHRoaXMuX3BvcHVwSW1hZ2UgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XG4gICAgdGhpcy5fcHJldmlld1RleHQgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLm1vZGFsX19wcmV2aWV3LXRpdGxlXCJcbiAgICApO1xuICB9XG5cbiAgb3BlbihuYW1lLCBsaW5rKSB7XG4gICAgdGhpcy5fcG9wdXBJbWFnZS5zcmMgPSBsaW5rO1xuICAgIHRoaXMuX3BvcHVwSW1hZ2UuYWx0ID0gbmFtZTtcbiAgICB0aGlzLl9wcmV2aWV3VGV4dC50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgc3VwZXIub3BlbigpO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aEltYWdlO1xuIl0sIm5hbWVzIjpbImNvbnN0cnVjdG9yIiwic2V0dGluZ3MiLCJmb3JtRWxlbWVudCIsInRoaXMiLCJfZm9ybUVsZW1lbnQiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uIiwicXVlcnlTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9pbnB1dEVsZW1lbnRzIiwicXVlcnlTZWxlY3RvckFsbCIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWxlbWVudCIsImVycm9yTWVzc2FnZUVsIiwiaWQiLCJjbGFzc0xpc3QiLCJhZGQiLCJ0ZXh0Q29udGVudCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwicmVtb3ZlIiwiX2NoZWNrRm9ybVZhbGlkaXR5IiwiZXZlcnkiLCJpbnB1dCIsInZhbGlkaXR5IiwidmFsaWQiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJkaXNhYmxlZCIsIl9zZXRFdmVudExpc3RlbmVycyIsImZvckVhY2giLCJhZGRFdmVudExpc3RlbmVyIiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2dCIsInByZXZlbnREZWZhdWx0IiwiX3JlZiIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50IiwiZG9jdW1lbnQiLCJfcG9wdXBFbGVtZW50Q2xvc2VCdG4iLCJvcGVuIiwiX2hhbmRsZUVzY0Nsb3NlIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsIlBvcHVwIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX3BvcHVwRm9ybSIsIl9oYW5kbGVGb3JtU3VibWl0Iiwic2V0TG9hZGluZyIsImlzTG9hZGluZyIsIl9nZXRJbnB1dFZhbHVlcyIsIl9pbnB1dExpc3QiLCJfZm9ybVZhbHVlcyIsIm5hbWUiLCJ2YWx1ZSIsInJlc2V0IiwiYXBpIiwiYmFzZVVybCIsImF1dGhUb2tlbiIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9hdXRoVG9rZW4iLCJfaGVhZGVycyIsIl9wcm9jZXNzUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0VXNlckluZm8iLCJmZXRjaCIsImF1dGhvcml6YXRpb24iLCJ0aGVuIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJnZXRJbml0aWFsQ2FyZHMiLCJ1cGRhdGVQcm9maWxlIiwiaW5wdXRWYWx1ZXMiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFib3V0IiwiZGVzY3JpcHRpb24iLCJhZGRDYXJkIiwiX3JlZjIiLCJsaW5rIiwicmVtb3ZlQ2FyZCIsImNhcmRJZCIsImxvZyIsImxpa2VDYXJkIiwidW5saWtlQ2FyZCIsInVwZGF0ZVByb2ZpbGVBdmF0YXIiLCJhdmF0YXIiLCJwcm9maWxlRWRpdEJ1dHRvbiIsInByb2ZpbGVFZGl0TW9kYWwiLCJhZGRDYXJkTW9kYWwiLCJwcm9maWxlVGl0bGUiLCJwcm9maWxlRGVzY3JpcHRpb24iLCJhZGRDYXJkRm9ybUVsZW1lbnQiLCJjYXJkTGlzdEVMIiwicHJvZmlsZUNsb3NlQnV0dG9uIiwiY2FyZENsb3NlQnV0dG9uIiwiYWRkTmV3Q2FyZEJ1dHRvbiIsImRlbGV0ZVBvcHVwQ2xvc2VCdXR0b24iLCJwcm9maWxlQXZhdGFyQnV0dG9uIiwiYXZhdGFyUG9wdXBDbG9zZUJ1dHRvbiIsImF2YXRhckVsZW1lbnQiLCJlZGl0QXZhdGFyTW9kYWwiLCJwcm9maWxlRGVzY3JpcHRpb25JbnB1dCIsInByb2ZpbGVUaXRsZUlucHV0IiwiY2FyZFRpdGxlSW5wdXQiLCJjYXJkTGlua0lucHV0IiwiaGFuZGxlQ2FyZExpa2VDbGljayIsImlzTGlrZWQiLCJjYXJkRGF0YSIsIl9saWtlcyIsIl9yZW5kZXJMaWtlcyIsImVkaXRBdmF0YXJQb3B1cCIsIlBvcHVwV2l0aEZvcm0iLCJkYXRhIiwidXNlckRhdGEiLCJ1c2VySW5mbyIsInNldFVzZXJBdmF0YXIiLCJmaW5hbGx5IiwiX2F2YXRhckVsZW1lbnQiLCJzZXRVc2VySW5mbyIsInNyYyIsImVkaXRQcm9maWxlUG9wdXAiLCJsb2NhdGlvbiIsInJlbG9hZCIsImFkZENhcmRQb3B1cCIsInJlbmRlckNhcmQiLCJkZWxldGVDYXJkUG9wdXAiLCJfZGVsZXRlQnV0dG9uIiwic2V0U3VibWl0QWN0aW9uIiwiYWN0aW9uIiwiX2hhbmRsZVN1Ym1pdCIsImV2ZW50IiwiaGFuZGxlRGVsZXRlQ2FyZENsaWNrIiwiZWRpdEZvcm1FbGVtZW50IiwiYWRkRm9ybUVsZW1lbnQiLCJhdmF0YXJFZGl0Rm9ybUVsZW1lbnQiLCJlZGl0Rm9ybVZhbGlkYXRvciIsIkZvcm1WYWxpZGF0b3IiLCJhZGRGb3JtVmFsaWRhdG9yIiwiYXZhdGFyRWRpdEZvcm1WYWxpZGF0b3IiLCJjYXJkU2VjdGlvbiIsIm5ld0NhcmQiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVDYXJkQ2xpY2siLCJfaWQiLCJvd25lcklkIiwidXNlcklkIiwibXlJZCIsIl9uYW1lIiwiX2xpbmsiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUNhcmRDbGljayIsIl9oYW5kbGVEZWxldGVDYXJkQ2xpY2siLCJfaGFuZGxlQ2FyZExpa2VDbGljayIsIl9saWtlc051bSIsIl9jYXJkSWQiLCJfdXNlcklkIiwiX293bmVySWQiLCJfbXlJZCIsImdldElkIiwiX2dldERhdGEiLCJzZXRMaWtlc1N0YXR1cyIsImxpa2VCdXR0b24iLCJfY2FyZEVsZW1lbnQiLCJfcmVtb3ZlQ2FyZCIsIl9oaWRlRGVsZXRlQnV0dG9uIiwiZ2V0VmlldyIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJpbm5lclRleHQiLCJhbHQiLCJhZGRJdGVtIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiaXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwicmV2ZXJzZSIsImltYWdlUHJldmlld1BvcHVwIiwiX3BvcHVwSW1hZ2UiLCJfcHJldmlld1RleHQiLCJ1c2VySW5mb0RhdGEiLCJmaWxsUHJvZmlsZUZvcm0iXSwic291cmNlUm9vdCI6IiJ9